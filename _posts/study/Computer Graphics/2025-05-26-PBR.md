---
title: PBR (Physically Based Rendering)
layout: post
category: study
tags: [directx, computer graphics, hlsl, 3d modeling]
published: false
---

## Physically Based Rendering (Lighting & Shading)

Okay, this is a very difficult topics I could say from the point of muggles. (when I say muggle, it's not like dumb people, just people who don't know the background of physical rendering which include me). But we can simply narrow down about what we know. In order to fully understand physical based rendering, we need to understand how light behaves in real world. Basically we need to go over the physics in Light.

First of all, the one of the principle of physics is energy conservation. What !? where this idea coming from? When we think of the physics of light. Light waves carry the energy, basically saying that the density of the energy flow is equal to the product of the magnitudes of the electric and magnetic field. 

Rendering, we care about the average energy flow over time, which is proportional to the squared wave amplitude, and this "average energy flow density" is also called irradiance. Summation / Subtraction of wave can be described as constructive and destructive interference, and also called coherent addition. Since those are not the most often case. If the waves are mutually incoherent, which means there wave's phase can be random. We can simply say that they can interfere each other resulting almost "zero" amplitude or "some amplitude" in different location. This basically tells us that the energy gained via constructive interference and the energy lost via destructive interference always cancel out, and the energy is conserved.

Then, we can talk about the light interaction with molecule. Basically, when light hits the matter, then it separates the positive and negative charges, forms dipoles, then this matter itself radiates the energy back out as form of heat or form of new waves (scattered light) in new direction. So far, in reality, it is hard to simulate all these behavior. 

Second, PBR should be microfacet model.

* Metal / Non-Metal

* Non-Metal 중에서도 사람의 피부 같은 경우는, there is time where the light bounce off right away, but diffuse inside of the skin, then bounce off. These are called subsurface scattering.

* 빛이 반사되는 영역이 있다고 한다고 하고, 한 Pixel 보다 작다고 하면, 굳이 거리를 표현할필요가 없다. Specular 도 같은 경우는 반사광이기 때문에 바로 나오고, Diffuse 반사같은 경우도, 거리에 따른 Diffuse 반사들이 나오는게 아니라 한 Pixel 에서 나오게끔..

### Radiance
빛이 얼마나 들어오는가? 조명이 얼마나 빛을 강하게 쏴주는가? 

그리고 빛의 전자기적 Spectrum 까지 고려한 Rendering 기술을 Spectral Rendering 이라고 한다.

## BRDF

### Reflectance Equation

## Unreal Engine PBR - 2013
BRDF 식들 

### BRDF


### Material Model
BaseColor
Metallic
Roughness
Cavity (Ambient Occlusion)

### IBL
* Irridiance: 빛을 받는 양 즉 모든 빛에대해서 세기를 표현하기 어려우니, Irradiance IBL map 을 만들어서 Normal 값을 추적해서, 한 Pixel 만 가져오기. 즉 빛이 가는 방향들을 모두 더 하다보니, 빛들이 뭉게지는걸 하나의 Map 으로 만들어 놓은것.
* 그리고 결국엔 이게 바로 Diffuse Map 이랑 연관된다는걸 

* Specular 도 마찬가지로 Specular Mapping 을 사용하고 + LUT (Look up Textuer) 라는걸 사용한다.

## Resource
* [Presentation - Physics and Math of Shading](chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://blog.selfshadow.com/publications/s2015-shading-course/hoffman/s2015_pbs_physics_math_slides.pdf)
* [Youtube - Physics and Math of Shading](https://www.youtube.com/watch?v=j-A0mwsJRmk&ab_channel=ACMSIGGRAPH)
* [Moving Frostbite to Physically based rendering](https://seblagarde.wordpress.com/2015/07/14/siggraph-2014-moving-frostbite-to-physically-based-rendering/)